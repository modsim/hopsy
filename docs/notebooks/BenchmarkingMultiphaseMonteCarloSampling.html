
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Benchmarking Multiphase Monte Carlo Sampling &#8212; hopsy 1.5.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=e0a75244"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/BenchmarkingMultiphaseMonteCarloSampling';</script>
    <link rel="icon" href="../_static/hopsy.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Birkhoff polytope" href="BirkhoffPolytope.html" />
    <link rel="prev" title="TMVN Sampling" href="TruncatedGaussianProposal.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/hopsy.png" class="logo__image only-light" alt="hopsy 1.5.0 documentation - Home"/>
    <script>document.write(`<img src="../_static/hopsy.png" class="logo__image only-dark" alt="hopsy 1.5.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../firststeps.html">
    First Steps
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../userguide.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../zreference.html">
    Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../firststeps.html">
    First Steps
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../userguide.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../zreference.html">
    Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="QuickTutorial.html">A Quick Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamplingAdvice.html">A Guide to Sampling Your First Model With hopsy</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConstrainedSampling.html">Constrained Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParallelTemperingMultiprocessing.html">Parallel Tempering using pure Python (Multiprocessing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="CheckIfPolytopeIsEmpty.html">Checking polytope feasibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="EqualityConstraints.html">Equality Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="TruncatedGaussianProposal.html">TMVN Sampling</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Benchmarking Multiphase Monte Carlo Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="BirkhoffPolytope.html">Birkhoff polytope</a></li>
<li class="toctree-l1"><a class="reference internal" href="MultiphaseMonteCarlo.html">Demo for Multiphase Monte Carlo in hopsy</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParallelTemperingMPI.html">Parallel Tempering with MPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="eval_pt_samples.html">Visualizing samples from parallel tempering</a></li>
<li class="toctree-l1"><a class="reference internal" href="Callbacks.html">Callbacks</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
  
    
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../examples.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Benchmarking...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Benchmarking-Multiphase-Monte-Carlo-Sampling">
<h1>Benchmarking Multiphase Monte Carlo Sampling<a class="headerlink" href="#Benchmarking-Multiphase-Monte-Carlo-Sampling" title="Link to this heading">#</a></h1>
<section id="Motivation">
<h2>Motivation<a class="headerlink" href="#Motivation" title="Link to this heading">#</a></h2>
<p>As a methods researcher one is often interested in testing new methods and benchmarking them together with state-of-the-art algorithms. hopsy provides the framework for conducting such comparisons, because it allows the methods researcher to focus on the algorithms, while the scaffolding, i.e., I/O, convergence diagnostics, and state-of-the-art implementations of existing algorithms are provided.</p>
<p>We show in this notebook how one can adapt build a multiphase monte carlo sampling plugin for hopsy</p>
<section id="Preimplemented-Multiphase-sampling">
<h3>Preimplemented Multiphase sampling<a class="headerlink" href="#Preimplemented-Multiphase-sampling" title="Link to this heading">#</a></h3>
<p>The multiphase Monte Carlo algorithm is also available preimplemented in hopsy, see MultiphaseMonteCarlo.ipynb for a short example</p>
</section>
</section>
<section id="Background">
<h2>Background<a class="headerlink" href="#Background" title="Link to this heading">#</a></h2>
<p>Instead of rounding before sampling, multiphase monte carlo sampling rounds adaptively based on the samples of the Markov chain during a run. It has been reported to be an efficient strategy, if the underlying Markov chain is efficient enough.</p>
<p>The Idea has found previous adaption in the artificially centered coordinate hit-and-run and the optGP sampler. However, Coordinate Hit-and-Run Rounded showed greater and more stable performance (<a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/28158334/">https://pubmed.ncbi.nlm.nih.gov/28158334/</a>) than both of those algorithms.</p>
<p>The idea is resurrected and shown to be efficient given a better Markov chain implementation. See <a class="reference external" href="https://drops.dagstuhl.de/opus/volltexte/2021/13820/pdf/LIPIcs-SoCG-2021-21.pdf">https://drops.dagstuhl.de/opus/volltexte/2021/13820/pdf/LIPIcs-SoCG-2021-21.pdf</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hopsy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">PolyRound</span>
</pre></div>
</div>
</div>
</section>
<section id="Custom-proposals">
<h2>Custom proposals<a class="headerlink" href="#Custom-proposals" title="Link to this heading">#</a></h2>
<p>In case the proposal you want to benchmark is not already implemented, it is possible to implement it yourself in a small class. It is then possible to seamlessy integrate this proposal into existing workflows with hopsy. As an example, we implement Overrelaxed Hit-and-Run, see <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2015IJMPC..2650010D/abstract">https://ui.adsabs.harvard.edu/abs/2015IJMPC..2650010D/abstract</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">OverrelaxedHitAndRunProposal</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">:</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">Problem</span><span class="p">,</span> <span class="n">starting_point</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-10</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">starting_point</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proposal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span>

    <span class="k">def</span> <span class="nf">propose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method is called by hopsy.MarkovChain. Returns the proposal&quot;&quot;&quot;</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">direction</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">inverse_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">@</span> <span class="n">direction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">forward_distance</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">inverse_distances</span><span class="p">)</span>
        <span class="n">backward_distance</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">inverse_distances</span><span class="p">)</span>

        <span class="n">L</span> <span class="o">=</span> <span class="n">forward_distance</span> <span class="o">-</span> <span class="n">backward_distance</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">backward_distance</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span>
        <span class="n">t_1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">L</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">()))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">t_0</span> <span class="o">=</span> <span class="o">-</span><span class="n">backward_distance</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">proposal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">+</span> <span class="p">(</span><span class="n">t_1</span> <span class="o">-</span> <span class="n">t_0</span><span class="p">)</span> <span class="o">*</span> <span class="n">direction</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposal</span>
</pre></div>
</div>
</div>
</section>
<section id="More-complex-custom-sampling-schemes">
<h2>More complex custom sampling schemes<a class="headerlink" href="#More-complex-custom-sampling-schemes" title="Link to this heading">#</a></h2>
<p>In addition to custom proposals, it is also possible to implement adaptive workflows. In this case we implement the adaptive rounding from <a class="reference external" href="https://drops.dagstuhl.de/opus/volltexte/2021/13820/pdf/LIPIcs-SoCG-2021-21.pdf">https://drops.dagstuhl.de/opus/volltexte/2021/13820/pdf/LIPIcs-SoCG-2021-21.pdf</a> using the Billiard walk that is already implemented in hopsy.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rounding based on samples, as suggested in https://drops.dagstuhl.de/opus/volltexte/2021/13820/pdf/LIPIcs-SoCG-2021-21.pdf</span>
<span class="k">def</span> <span class="nf">svd_rounding</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">polytope</span><span class="p">):</span>
    <span class="c1"># We concatenate them samples to [n_dim, n_iterations] for rounding</span>
    <span class="n">stacked_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
        <span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">samples</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">samples</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
    <span class="p">)</span>

    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">stacked_samples</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">stacked_samples</span> <span class="o">=</span> <span class="n">stacked_samples</span> <span class="o">-</span> <span class="n">mean</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">stacked_samples</span><span class="p">)</span>
    <span class="c1"># Rescaling as mentioned in  https://drops.dagstuhl.de/opus/volltexte/2021/13820/pdf/LIPIcs-SoCG-2021-21.pdf</span>
    <span class="n">s_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">S</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">2.0</span><span class="p">:</span>
        <span class="n">S</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">S</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">Vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">Vh</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">rounding_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Vh</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>

    <span class="c1"># Transforms current last samples into new polytope</span>
    <span class="n">sub_problem</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span>
        <span class="n">polytope</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">polytope</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="n">rounding_matrix</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">mean</span>
    <span class="p">)</span>
    <span class="n">starting_points</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="n">sub_problem</span><span class="p">,</span> <span class="p">[</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="p">)</span>
    <span class="n">polytope</span><span class="o">.</span><span class="n">apply_shift</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
    <span class="n">polytope</span><span class="o">.</span><span class="n">apply_transformation</span><span class="p">(</span><span class="n">rounding_matrix</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">s_ratio</span><span class="p">,</span> <span class="n">starting_points</span><span class="p">,</span> <span class="n">polytope</span><span class="p">,</span> <span class="n">sub_problem</span>
</pre></div>
</div>
</div>
</section>
<section id="Helper-functions">
<h2>Helper functions<a class="headerlink" href="#Helper-functions" title="Link to this heading">#</a></h2>
<p>In this section we implement some helper functions for executing the benchmarks as well as a function which constructs our benchmark problems</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Helper functions for calling the sampling algorithms and defining the polytopes</span>
<span class="k">def</span> <span class="nf">run_multiphase_sampling</span><span class="p">(</span>
    <span class="n">proposal</span><span class="p">,</span>
    <span class="n">polytope</span><span class="p">,</span>
    <span class="n">seeds</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span>
    <span class="n">target_ess</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">steps_per_phase</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">starting_points</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">limit_singular_ratio_value</span> <span class="o">=</span> <span class="mf">2.3</span>  <span class="c1"># from https://drops.dagstuhl.de/opus/volltexte/2021/13820/pdf/LIPIcs-SoCG-2021-21.pdf</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">starting_points</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">seeds</span><span class="p">)</span>
    <span class="n">rngs</span> <span class="o">=</span> <span class="p">[</span><span class="n">hopsy</span><span class="o">.</span><span class="n">RandomNumberGenerator</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">seeds</span><span class="p">]</span>

    <span class="n">ess</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">s_ratio</span> <span class="o">=</span> <span class="n">limit_singular_ratio_value</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">sampling_time</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">last_iteration_did_rounding</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">ess</span> <span class="o">&lt;</span> <span class="n">target_ess</span><span class="p">:</span>
        <span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">iter:&quot;</span><span class="p">,</span> <span class="n">iterations</span><span class="p">)</span>
        <span class="n">internal_polytope</span> <span class="o">=</span> <span class="n">polytope</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">internal_polytope</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">internal_polytope</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
        <span class="n">markov_chains</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">hopsy</span><span class="o">.</span><span class="n">MarkovChain</span><span class="p">(</span><span class="n">proposal</span><span class="o">=</span><span class="n">proposal</span><span class="p">,</span> <span class="n">problem</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">starting_point</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">starting_points</span>
        <span class="p">]</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">acceptance_rate</span><span class="p">,</span> <span class="n">_samples</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
            <span class="n">markov_chains</span><span class="p">,</span> <span class="n">rngs</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">steps_per_phase</span><span class="p">,</span> <span class="n">thinning</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_procs</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">b</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="n">A</span> <span class="o">@</span> <span class="n">_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">b</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="n">A</span> <span class="o">@</span> <span class="n">_samples</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">b</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="n">A</span> <span class="o">@</span> <span class="n">_samples</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">b</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="n">A</span> <span class="o">@</span> <span class="n">_samples</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">sampling_time</span> <span class="o">+=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>

        <span class="k">if</span> <span class="n">s_ratio</span> <span class="o">&gt;</span> <span class="n">limit_singular_ratio_value</span><span class="p">:</span>
            <span class="n">samples</span> <span class="o">=</span> <span class="n">_samples</span>
            <span class="c1"># also measures the rounding time</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">s_ratio</span><span class="p">,</span> <span class="n">starting_points</span><span class="p">,</span> <span class="n">internal_polytope</span><span class="p">,</span> <span class="n">sub_problem</span> <span class="o">=</span> <span class="n">svd_rounding</span><span class="p">(</span>
                <span class="n">samples</span><span class="p">,</span> <span class="n">internal_polytope</span>
            <span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">sampling_time</span> <span class="o">+=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">s_ratio:&quot;</span><span class="p">,</span> <span class="n">s_ratio</span><span class="p">)</span>
            <span class="n">last_iteration_did_rounding</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">last_iteration_did_rounding</span><span class="p">:</span>
                <span class="c1"># next operation transforms last samples to current space before concatenating</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">samples</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
                        <span class="n">sub_problem</span><span class="p">,</span> <span class="p">[</span><span class="n">samples</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                    <span class="p">)</span>
                <span class="n">last_iteration_did_rounding</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">samples</span><span class="p">,</span> <span class="n">_samples</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">starting_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="n">ess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">hopsy</span><span class="o">.</span><span class="n">ess</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">ess&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ess</span><span class="p">))</span>
        <span class="n">steps_per_phase</span> <span class="o">+=</span> <span class="mi">100</span>

    <span class="c1"># transforms back to full space</span>
    <span class="n">_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
        <span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">polytope</span><span class="o">.</span><span class="n">transformation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">_samples</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">back_transform</span><span class="p">(</span>
            <span class="n">hopsy</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span>
                <span class="n">A</span><span class="o">=</span><span class="n">internal_polytope</span><span class="o">.</span><span class="n">A</span><span class="p">,</span>
                <span class="n">b</span><span class="o">=</span><span class="n">internal_polytope</span><span class="o">.</span><span class="n">b</span><span class="p">,</span>
                <span class="n">transformation</span><span class="o">=</span><span class="n">internal_polytope</span><span class="o">.</span><span class="n">transformation</span><span class="p">,</span>
                <span class="n">shift</span><span class="o">=</span><span class="n">internal_polytope</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">[</span><span class="n">samples</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])],</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">_samples</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">ess</span><span class="p">,</span> <span class="n">sampling_time</span>


<span class="k">def</span> <span class="nf">run_sampling</span><span class="p">(</span>
    <span class="n">proposal</span><span class="p">,</span>
    <span class="n">polytope</span><span class="p">,</span>
    <span class="n">seeds</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span>
    <span class="n">target_ess</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">steps_per_phase</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">starting_points</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span>
    <span class="n">thinning</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">rngs</span> <span class="o">=</span> <span class="p">[</span><span class="n">hopsy</span><span class="o">.</span><span class="n">RandomNumberGenerator</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">seeds</span><span class="p">]</span>

    <span class="n">problem</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">polytope</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">polytope</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
    <span class="n">thinning</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">thinning</span> <span class="k">if</span> <span class="n">thinning</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">ess</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># also measures the rounding time</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">rounded_problem</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
    <span class="c1"># transforms starting points into rounded space</span>
    <span class="n">starting_points</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rounded_problem</span><span class="p">,</span> <span class="n">starting_points</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">sampling_time</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">markov_chains</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">hopsy</span><span class="o">.</span><span class="n">MarkovChain</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">rounded_problem</span><span class="p">,</span> <span class="n">starting_point</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">starting_points</span>
    <span class="p">]</span>
    <span class="k">while</span> <span class="n">ess</span> <span class="o">&lt;</span> <span class="n">target_ess</span><span class="p">:</span>
        <span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">iter:&quot;</span><span class="p">,</span> <span class="n">iterations</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starting_points</span><span class="p">)):</span>
            <span class="n">markov_chains</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">proposal</span> <span class="o">=</span> <span class="n">proposal</span><span class="p">(</span>
                <span class="n">rounded_problem</span><span class="p">,</span> <span class="n">starting_point</span><span class="o">=</span><span class="n">starting_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">acceptance_rate</span><span class="p">,</span> <span class="n">_samples</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
            <span class="n">markov_chains</span><span class="p">,</span> <span class="n">rngs</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">steps_per_phase</span><span class="p">,</span> <span class="n">thinning</span><span class="o">=</span><span class="n">thinning</span><span class="p">,</span> <span class="n">n_procs</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">sampling_time</span> <span class="o">+=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>

        <span class="n">samples</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">_samples</span> <span class="k">if</span> <span class="n">samples</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">samples</span><span class="p">,</span> <span class="n">_samples</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">starting_points</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rounded_problem</span><span class="p">,</span> <span class="n">samples</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>

        <span class="n">ess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">hopsy</span><span class="o">.</span><span class="n">ess</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">ess&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ess</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;samples&quot;</span><span class="p">,</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># transforms back to full space</span>
    <span class="n">_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
        <span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">polytope</span><span class="o">.</span><span class="n">transformation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">_samples</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">back_transform</span><span class="p">(</span>
            <span class="n">hopsy</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span>
                <span class="n">A</span><span class="o">=</span><span class="n">polytope</span><span class="o">.</span><span class="n">A</span><span class="p">,</span>
                <span class="n">b</span><span class="o">=</span><span class="n">polytope</span><span class="o">.</span><span class="n">b</span><span class="p">,</span>
                <span class="n">transformation</span><span class="o">=</span><span class="n">polytope</span><span class="o">.</span><span class="n">transformation</span><span class="p">,</span>
                <span class="n">shift</span><span class="o">=</span><span class="n">polytope</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">[</span><span class="n">samples</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])],</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">_samples</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">ess</span><span class="p">,</span> <span class="n">sampling_time</span>


<span class="k">def</span> <span class="nf">generate_polytope</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;BP5&quot;</span><span class="p">:</span>
        <span class="n">bp</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">BirkhoffPolytope</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">polytope</span> <span class="o">=</span> <span class="n">PolyRound</span><span class="o">.</span><span class="n">mutable_classes</span><span class="o">.</span><span class="n">polytope</span><span class="o">.</span><span class="n">Polytope</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
        <span class="n">polytope</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
        <span class="n">parameter_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">polytope</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">polytope</span><span class="p">,</span> <span class="s2">&quot;5D Birkhoff Polytope&quot;</span><span class="p">,</span> <span class="n">parameter_names</span>
    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;e_coli&quot;</span><span class="p">:</span>
        <span class="n">original_polytope</span> <span class="o">=</span> <span class="n">PolyRound</span><span class="o">.</span><span class="n">static_classes</span><span class="o">.</span><span class="n">parse_sbml_stoichiometry</span><span class="o">.</span><span class="n">StoichiometryParser</span><span class="o">.</span><span class="n">parse_sbml_cobrapy</span><span class="p">(</span>
            <span class="s2">&quot;../extern/hops/resources/e_coli_core/e_coli_core.xml&quot;</span>
        <span class="p">)</span>
        <span class="n">parameter_names</span> <span class="o">=</span> <span class="n">original_polytope</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">polytope</span> <span class="o">=</span> <span class="n">PolyRound</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">PolyRoundApi</span><span class="o">.</span><span class="n">simplify_polytope</span><span class="p">(</span><span class="n">original_polytope</span><span class="p">)</span>
        <span class="n">polytope</span> <span class="o">=</span> <span class="n">PolyRound</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">PolyRoundApi</span><span class="o">.</span><span class="n">transform_polytope</span><span class="p">(</span><span class="n">polytope</span><span class="p">)</span>
        <span class="n">polytope</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">polytope</span><span class="p">,</span> <span class="s2">&quot;e_coli_core&quot;</span><span class="p">,</span> <span class="n">parameter_names</span>
</pre></div>
</div>
</div>
</section>
<section id="Benchmark-parameters">
<h2>Benchmark parameters<a class="headerlink" href="#Benchmark-parameters" title="Link to this heading">#</a></h2>
<p>Next set up the benchmark parameters</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_ess</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">proposalTypes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Billiard walk&quot;</span><span class="p">:</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">BilliardWalkProposal</span><span class="p">,</span>
    <span class="s2">&quot;CHRRT&quot;</span><span class="p">:</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">UniformCoordinateHitAndRunProposal</span><span class="p">,</span>
    <span class="s2">&quot;OHRR&quot;</span><span class="p">:</span> <span class="n">OverrelaxedHitAndRunProposal</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">seeds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="n">problems_to_benchmark</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;BP5&quot;</span><span class="p">,</span> <span class="s2">&quot;e_coli&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="Benchmarking">
<h2>Benchmarking<a class="headerlink" href="#Benchmarking" title="Link to this heading">#</a></h2>
<p>Sample all problems with all sampling schemes, i.e., two for loops.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">iterations</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ess</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">times</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ess_t</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">parameter_names</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">problem_selection</span> <span class="ow">in</span> <span class="n">problems_to_benchmark</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmarking </span><span class="si">{problem_selection}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">samples</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">iterations</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ess</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">times</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ess_t</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">proposalTypes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">proposal&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="c1"># resets problem and starting points</span>
        <span class="n">preprocessed_polytope</span><span class="p">,</span> <span class="n">problem_name</span><span class="p">,</span> <span class="n">parameter_names</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">]</span> <span class="o">=</span> <span class="n">generate_polytope</span><span class="p">(</span>
            <span class="n">problem_selection</span>
        <span class="p">)</span>
        <span class="n">steps_per_phase</span> <span class="o">=</span> <span class="n">preprocessed_polytope</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">20</span>
        <span class="n">cheby</span> <span class="o">=</span> <span class="n">hopsy</span><span class="o">.</span><span class="n">compute_chebyshev_center</span><span class="p">(</span>
            <span class="n">hopsy</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">preprocessed_polytope</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">preprocessed_polytope</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">starting_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">cheby</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">seeds</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Billiard walk&quot;</span><span class="p">:</span>
            <span class="p">(</span>
                <span class="n">samples</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">],</span>
                <span class="n">iterations</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">],</span>
                <span class="n">ess</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">],</span>
                <span class="n">times</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">],</span>
            <span class="p">)</span> <span class="o">=</span> <span class="n">run_multiphase_sampling</span><span class="p">(</span>
                <span class="n">proposal</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
                <span class="n">polytope</span><span class="o">=</span><span class="n">preprocessed_polytope</span><span class="p">,</span>
                <span class="n">seeds</span><span class="o">=</span><span class="n">seeds</span><span class="p">,</span>
                <span class="n">target_ess</span><span class="o">=</span><span class="n">target_ess</span><span class="p">,</span>
                <span class="n">steps_per_phase</span><span class="o">=</span><span class="n">steps_per_phase</span><span class="p">,</span>
                <span class="n">starting_points</span><span class="o">=</span><span class="n">starting_points</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thinning</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mi">1</span>
                <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;CHRRT&quot;</span>
                <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">preprocessed_polytope</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">samples</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">],</span> <span class="n">iterations</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">],</span> <span class="n">ess</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">],</span> <span class="n">times</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_sampling</span><span class="p">(</span>
                <span class="n">proposal</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
                <span class="n">polytope</span><span class="o">=</span><span class="n">preprocessed_polytope</span><span class="p">,</span>
                <span class="n">seeds</span><span class="o">=</span><span class="n">seeds</span><span class="p">,</span>
                <span class="n">target_ess</span><span class="o">=</span><span class="n">target_ess</span><span class="p">,</span>
                <span class="n">steps_per_phase</span><span class="o">=</span><span class="n">steps_per_phase</span><span class="p">,</span>
                <span class="n">starting_points</span><span class="o">=</span><span class="n">starting_points</span><span class="p">,</span>
                <span class="n">thinning</span><span class="o">=</span><span class="n">thinning</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">ess_t</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ess</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">/</span> <span class="n">times</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>

    <span class="c1"># check convergence</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;rhat:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">hopsy</span><span class="o">.</span><span class="n">rhat</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">ess&quot;</span><span class="p">,</span> <span class="n">ess</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">times&quot;</span><span class="p">,</span> <span class="n">times</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">ess/t&quot;</span><span class="p">,</span> <span class="n">ess_t</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Benchmarking {problem_selection}
        proposal Billiard walk
Set parameter Username
Academic license - for non-commercial use only - expires 2023-11-30
                iter: 1
                s_ratio: 1.3847452299003395
                ess 231.4835868364245
                iter: 2
                ess 627.6793244654275
                iter: 3
                ess 990.5612889618237
                iter: 4
                ess 1583.2881720652492
        proposal CHRRT
                iter: 1
                ess 447.64227280442987, samples 320
                iter: 2
                ess 863.8258778056024, samples 640
                iter: 3
                ess 1324.526979068286, samples 960
        proposal OHRR
                iter: 1
                ess 7.066940654698069, samples 320
                iter: 2
                ess 8.978791384060571, samples 640
                iter: 3
                ess 10.822526600431221, samples 960
                iter: 4
                ess 14.644470085574461, samples 1280
                iter: 5
                ess 18.35148293619599, samples 1600
                iter: 6
                ess 16.62222639251434, samples 1920
                iter: 7
                ess 23.833699742670035, samples 2240
                iter: 8
                ess 41.20876776311011, samples 2560
                iter: 9
                ess 57.886912910344414, samples 2880
                iter: 10
                ess 37.382289849801055, samples 3200
                iter: 11
                ess 62.344564915244966, samples 3520
                iter: 12
                ess 79.15850821798082, samples 3840
                iter: 13
                ess 74.36071172518442, samples 4160
                iter: 14
                ess 62.95342031751828, samples 4480
                iter: 15
                ess 113.47926517779857, samples 4800
                iter: 16
                ess 121.72186371924973, samples 5120
                iter: 17
                ess 113.3492478009126, samples 5440
                iter: 18
                ess 127.77424100111836, samples 5760
                iter: 19
                ess 136.9696137423155, samples 6080
                iter: 20
                ess 144.16940525794976, samples 6400
                iter: 21
                ess 139.2192539731686, samples 6720
                iter: 22
                ess 156.53500273176687, samples 7040
                iter: 23
                ess 175.14217193906293, samples 7360
                iter: 24
                ess 182.43273042583925, samples 7680
                iter: 25
                ess 191.5815328961723, samples 8000
                iter: 26
                ess 210.41931304680313, samples 8320
                iter: 27
                ess 224.31970085590208, samples 8640
                iter: 28
                ess 226.62768566905982, samples 8960
                iter: 29
                ess 237.75902910720876, samples 9280
                iter: 30
                ess 243.67493216855976, samples 9600
                iter: 31
                ess 257.3021980390406, samples 9920
                iter: 32
                ess 273.8199561717506, samples 10240
                iter: 33
                ess 294.20112361746465, samples 10560
                iter: 34
                ess 293.48158227555297, samples 10880
                iter: 35
                ess 300.45975910082853, samples 11200
                iter: 36
                ess 317.7535136265973, samples 11520
                iter: 37
                ess 336.3692862259476, samples 11840
                iter: 38
                ess 331.9082473463359, samples 12160
                iter: 39
                ess 346.2916329510095, samples 12480
                iter: 40
                ess 357.96934334556954, samples 12800
                iter: 41
                ess 363.54227418015665, samples 13120
                iter: 42
                ess 383.5858067647125, samples 13440
                iter: 43
                ess 382.0381927501071, samples 13760
                iter: 44
                ess 401.5143488947238, samples 14080
                iter: 45
                ess 420.64939968763684, samples 14400
                iter: 46
                ess 449.08326901564647, samples 14720
                iter: 47
                ess 452.80046753169904, samples 15040
                iter: 48
                ess 450.12839321675506, samples 15360
                iter: 49
                ess 462.2771927927099, samples 15680
                iter: 50
                ess 461.9902539847381, samples 16000
                iter: 51
                ess 481.53977928686703, samples 16320
                iter: 52
                ess 508.6649066292897, samples 16640
                iter: 53
                ess 504.20807661962795, samples 16960
                iter: 54
                ess 521.5147013905246, samples 17280
                iter: 55
                ess 544.7993417778594, samples 17600
                iter: 56
                ess 535.5840942302711, samples 17920
                iter: 57
                ess 551.2635026918439, samples 18240
                iter: 58
                ess 569.2310737012456, samples 18560
                iter: 59
                ess 588.0058452604753, samples 18880
                iter: 60
                ess 593.8488910778029, samples 19200
                iter: 61
                ess 615.6596139884347, samples 19520
                iter: 62
                ess 635.4306913517988, samples 19840
                iter: 63
                ess 646.0405907460345, samples 20160
                iter: 64
                ess 644.4425753035002, samples 20480
                iter: 65
                ess 646.8043239236227, samples 20800
                iter: 66
                ess 664.2919147742286, samples 21120
                iter: 67
                ess 674.3680356181259, samples 21440
                iter: 68
                ess 680.3837001518382, samples 21760
                iter: 69
                ess 698.4208197353897, samples 22080
                iter: 70
                ess 709.8115678575414, samples 22400
                iter: 71
                ess 722.2190007599912, samples 22720
                iter: 72
                ess 729.2378725295657, samples 23040
                iter: 73
                ess 749.2232824472641, samples 23360
                iter: 74
                ess 750.6074062950678, samples 23680
                iter: 75
                ess 779.3189674698466, samples 24000
                iter: 76
                ess 793.5895044612517, samples 24320
                iter: 77
                ess 788.1310770304416, samples 24640
                iter: 78
                ess 813.4174519025988, samples 24960
                iter: 79
                ess 818.7102630963842, samples 25280
                iter: 80
                ess 825.1911302157964, samples 25600
                iter: 81
                ess 824.4797274295319, samples 25920
                iter: 82
                ess 832.4798666785565, samples 26240
                iter: 83
                ess 834.0921425432099, samples 26560
                iter: 84
                ess 856.1355113591557, samples 26880
                iter: 85
                ess 854.4998018509373, samples 27200
                iter: 86
                ess 870.6301466142817, samples 27520
                iter: 87
                ess 875.9356221946373, samples 27840
                iter: 88
                ess 891.1700748102612, samples 28160
                iter: 89
                ess 903.7960059093062, samples 28480
                iter: 90
                ess 886.178835961187, samples 28800
                iter: 91
                ess 867.117458057039, samples 29120
                iter: 92
                ess 881.9490684846811, samples 29440
                iter: 93
                ess 890.5241990028626, samples 29760
                iter: 94
                ess 913.5607895586063, samples 30080
                iter: 95
                ess 932.2398882121701, samples 30400
                iter: 96
                ess 951.138292074147, samples 30720
                iter: 97
                ess 964.61299347187, samples 31040
                iter: 98
                ess 983.6391765927045, samples 31360
                iter: 99
                ess 979.9236321935331, samples 31680
                iter: 100
                ess 1003.9031482727333, samples 32000
        Billiard walk rhat: 1.0061219415504485
        CHRRT rhat: 1.006207630257062
        OHRR rhat: 1.0070773467273284
        ess {&#39;Billiard walk&#39;: 1583.2881720652492, &#39;CHRRT&#39;: 1324.526979068286, &#39;OHRR&#39;: 1003.9031482727333}
        times {&#39;Billiard walk&#39;: 0.07052469253540039, &#39;CHRRT&#39;: 1.0217652320861816, &#39;OHRR&#39;: 6.2099902629852295}
        ess/t {&#39;Billiard walk&#39;: 22450.12512845066, &#39;CHRRT&#39;: 1296.3124379990331, &#39;OHRR&#39;: 161.65937558010646}
Benchmarking {problem_selection}
        proposal Billiard walk
                iter: 1
                s_ratio: 11.963156850679276
                ess 4.872243577042705
                iter: 2
                s_ratio: 23.96780496221293
                ess 5.133013163411473
                iter: 3
                s_ratio: 33.92514821624308
                ess 7.03213882586069
                iter: 4
                s_ratio: 23.480721222145224
                ess 21.114165738738418
                iter: 5
                s_ratio: 2.3472103720655264
                ess 652.8113104108883
                iter: 6
                s_ratio: 2.1462979782508014
                ess 957.7149285139645
                iter: 7
                ess 2013.7358952432155
        proposal CHRRT
                iter: 1
                ess 524.5375595198544, samples 480
                iter: 2
                ess 1188.850821488119, samples 960
        proposal OHRR
                iter: 1
                ess 6.269631083291744, samples 480
                iter: 2
                ess 7.323446416265532, samples 960
                iter: 3
                ess 8.888495302103292, samples 1440
                iter: 4
                ess 10.891013536977999, samples 1920
                iter: 5
                ess 10.43496232034734, samples 2400
                iter: 6
                ess 13.882887827988935, samples 2880
                iter: 7
                ess 15.49037801963015, samples 3360
                iter: 8
                ess 28.348358594863743, samples 3840
                iter: 9
                ess 33.099764817877734, samples 4320
                iter: 10
                ess 33.0052664057525, samples 4800
                iter: 11
                ess 32.11942312187279, samples 5280
                iter: 12
                ess 31.189888275506522, samples 5760
                iter: 13
                ess 34.00693166294697, samples 6240
                iter: 14
                ess 28.89547451072042, samples 6720
                iter: 15
                ess 38.45378494069976, samples 7200
                iter: 16
                ess 65.2195031632737, samples 7680
                iter: 17
                ess 76.91470052686886, samples 8160
                iter: 18
                ess 80.54628640266824, samples 8640
                iter: 19
                ess 120.38209736486483, samples 9120
                iter: 20
                ess 117.68114663878684, samples 9600
                iter: 21
                ess 124.75070422853102, samples 10080
                iter: 22
                ess 116.34655760555961, samples 10560
                iter: 23
                ess 124.18592232344665, samples 11040
                iter: 24
                ess 123.19323837905226, samples 11520
                iter: 25
                ess 144.46386173862024, samples 12000
                iter: 26
                ess 148.09968539854086, samples 12480
                iter: 27
                ess 147.95311563377672, samples 12960
                iter: 28
                ess 145.98511902334084, samples 13440
                iter: 29
                ess 158.51895860514378, samples 13920
                iter: 30
                ess 169.69689177481715, samples 14400
                iter: 31
                ess 174.49127005693168, samples 14880
                iter: 32
                ess 180.42261318891497, samples 15360
                iter: 33
                ess 192.96616757403754, samples 15840
                iter: 34
                ess 189.6869567126621, samples 16320
                iter: 35
                ess 185.9907738397535, samples 16800
                iter: 36
                ess 192.82170148987922, samples 17280
                iter: 37
                ess 204.65635395883973, samples 17760
                iter: 38
                ess 207.05551739174868, samples 18240
                iter: 39
                ess 216.1649396014175, samples 18720
                iter: 40
                ess 218.65560668780427, samples 19200
                iter: 41
                ess 224.67365262048054, samples 19680
                iter: 42
                ess 233.2337269481389, samples 20160
                iter: 43
                ess 245.04918297452195, samples 20640
                iter: 44
                ess 253.35676743095638, samples 21120
                iter: 45
                ess 268.2333892323007, samples 21600
                iter: 46
                ess 273.180948810766, samples 22080
                iter: 47
                ess 272.81001761513676, samples 22560
                iter: 48
                ess 257.916065225228, samples 23040
                iter: 49
                ess 253.42112849368127, samples 23520
                iter: 50
                ess 254.7582764932103, samples 24000
                iter: 51
                ess 258.4069792053966, samples 24480
                iter: 52
                ess 273.86342243004873, samples 24960
                iter: 53
                ess 284.17271357899097, samples 25440
                iter: 54
                ess 297.20253324691765, samples 25920
                iter: 55
                ess 302.52499273424024, samples 26400
                iter: 56
                ess 286.611087547339, samples 26880
                iter: 57
                ess 280.915655001863, samples 27360
                iter: 58
                ess 288.3164101913765, samples 27840
                iter: 59
                ess 300.42292722611387, samples 28320
                iter: 60
                ess 310.9952497255533, samples 28800
                iter: 61
                ess 313.1100359628566, samples 29280
                iter: 62
                ess 289.67804817589433, samples 29760
                iter: 63
                ess 293.2058222243669, samples 30240
                iter: 64
                ess 313.40643896165045, samples 30720
                iter: 65
                ess 293.8918695327726, samples 31200
                iter: 66
                ess 312.2361613765037, samples 31680
                iter: 67
                ess 322.9219106586677, samples 32160
                iter: 68
                ess 323.7545394540001, samples 32640
                iter: 69
                ess 346.32520571689747, samples 33120
                iter: 70
                ess 345.85424928547764, samples 33600
                iter: 71
                ess 358.3048911770299, samples 34080
                iter: 72
                ess 361.084743896345, samples 34560
                iter: 73
                ess 365.47086073740763, samples 35040
                iter: 74
                ess 383.39780160630573, samples 35520
                iter: 75
                ess 392.63094158894984, samples 36000
                iter: 76
                ess 398.9072807479651, samples 36480
                iter: 77
                ess 384.2964391944638, samples 36960
                iter: 78
                ess 384.7667317498958, samples 37440
                iter: 79
                ess 391.4770094651921, samples 37920
                iter: 80
                ess 386.190724216923, samples 38400
                iter: 81
                ess 382.85858663180676, samples 38880
                iter: 82
                ess 399.76548583077005, samples 39360
                iter: 83
                ess 406.45084635182735, samples 39840
                iter: 84
                ess 414.13634315764835, samples 40320
                iter: 85
                ess 424.17051913321086, samples 40800
                iter: 86
                ess 431.3602734254215, samples 41280
                iter: 87
                ess 422.556096368053, samples 41760
                iter: 88
                ess 432.7105172995434, samples 42240
                iter: 89
                ess 442.42073630007786, samples 42720
                iter: 90
                ess 451.6280904320013, samples 43200
                iter: 91
                ess 454.8288496773367, samples 43680
                iter: 92
                ess 459.7049865712104, samples 44160
                iter: 93
                ess 463.64262501125734, samples 44640
                iter: 94
                ess 454.3284616055022, samples 45120
                iter: 95
                ess 458.5231384856301, samples 45600
                iter: 96
                ess 467.2708211331568, samples 46080
                iter: 97
                ess 483.29399688389447, samples 46560
                iter: 98
                ess 489.9114233381726, samples 47040
                iter: 99
                ess 482.25565920814455, samples 47520
                iter: 100
                ess 488.76061956249976, samples 48000
                iter: 101
                ess 501.2216755056666, samples 48480
                iter: 102
                ess 509.151199607025, samples 48960
                iter: 103
                ess 512.2207523382951, samples 49440
                iter: 104
                ess 522.8707944154959, samples 49920
                iter: 105
                ess 530.9119480393842, samples 50400
                iter: 106
                ess 534.6566181063171, samples 50880
                iter: 107
                ess 537.3787114531068, samples 51360
                iter: 108
                ess 549.4299895513893, samples 51840
                iter: 109
                ess 545.6206413795908, samples 52320
                iter: 110
                ess 554.906174875836, samples 52800
                iter: 111
                ess 573.7119220600656, samples 53280
                iter: 112
                ess 569.4093051480813, samples 53760
                iter: 113
                ess 582.5343562401797, samples 54240
                iter: 114
                ess 592.634209761512, samples 54720
                iter: 115
                ess 601.744572032569, samples 55200
                iter: 116
                ess 605.1492755287037, samples 55680
                iter: 117
                ess 609.6353624312007, samples 56160
                iter: 118
                ess 613.5433468342083, samples 56640
                iter: 119
                ess 612.6171354877015, samples 57120
                iter: 120
                ess 618.69924574814, samples 57600
                iter: 121
                ess 628.4239828653435, samples 58080
                iter: 122
                ess 639.0665758373954, samples 58560
                iter: 123
                ess 640.8951662610747, samples 59040
                iter: 124
                ess 658.5648101217669, samples 59520
                iter: 125
                ess 672.2232482053716, samples 60000
                iter: 126
                ess 692.9192879813564, samples 60480
                iter: 127
                ess 701.1431658990771, samples 60960
                iter: 128
                ess 702.7340761365899, samples 61440
                iter: 129
                ess 707.3541719676651, samples 61920
                iter: 130
                ess 701.0297752389649, samples 62400
                iter: 131
                ess 706.8995244779946, samples 62880
                iter: 132
                ess 701.4908108847167, samples 63360
                iter: 133
                ess 689.3472197901951, samples 63840
                iter: 134
                ess 703.0003376779357, samples 64320
                iter: 135
                ess 708.2335934188095, samples 64800
                iter: 136
                ess 725.1838266734792, samples 65280
                iter: 137
                ess 735.3205579025181, samples 65760
                iter: 138
                ess 737.0318459845154, samples 66240
                iter: 139
                ess 754.6120288318377, samples 66720
                iter: 140
                ess 749.599634946338, samples 67200
                iter: 141
                ess 752.9040639999432, samples 67680
                iter: 142
                ess 766.2687113077193, samples 68160
                iter: 143
                ess 781.7276660620391, samples 68640
                iter: 144
                ess 790.6849726861673, samples 69120
                iter: 145
                ess 795.7596388427546, samples 69600
                iter: 146
                ess 799.5584972022341, samples 70080
                iter: 147
                ess 798.8247767068805, samples 70560
                iter: 148
                ess 797.1372057741078, samples 71040
                iter: 149
                ess 794.4879887657187, samples 71520
                iter: 150
                ess 798.4262537658255, samples 72000
                iter: 151
                ess 821.3439821865887, samples 72480
                iter: 152
                ess 836.785381934779, samples 72960
                iter: 153
                ess 833.192533643803, samples 73440
                iter: 154
                ess 824.2367310967214, samples 73920
                iter: 155
                ess 833.027337432633, samples 74400
                iter: 156
                ess 847.6213170291394, samples 74880
                iter: 157
                ess 883.55387018975, samples 75360
                iter: 158
                ess 888.4084908886016, samples 75840
                iter: 159
                ess 878.3560544642794, samples 76320
                iter: 160
                ess 867.8099320680594, samples 76800
                iter: 161
                ess 865.3342989956125, samples 77280
                iter: 162
                ess 868.7924805999716, samples 77760
                iter: 163
                ess 879.929282710091, samples 78240
                iter: 164
                ess 890.2971775291669, samples 78720
                iter: 165
                ess 906.4353233136444, samples 79200
                iter: 166
                ess 889.0828926155659, samples 79680
                iter: 167
                ess 873.9690238366554, samples 80160
                iter: 168
                ess 877.7212806671587, samples 80640
                iter: 169
                ess 894.2714684714002, samples 81120
                iter: 170
                ess 904.8308346920122, samples 81600
                iter: 171
                ess 912.2855347087361, samples 82080
                iter: 172
                ess 909.33882150071, samples 82560
                iter: 173
                ess 897.4864706687231, samples 83040
                iter: 174
                ess 899.1382480787717, samples 83520
                iter: 175
                ess 904.4533159265078, samples 84000
                iter: 176
                ess 910.0445241340408, samples 84480
                iter: 177
                ess 922.005723922873, samples 84960
                iter: 178
                ess 928.7932859860817, samples 85440
                iter: 179
                ess 908.783058613329, samples 85920
                iter: 180
                ess 895.3797915865479, samples 86400
                iter: 181
                ess 859.4890207031966, samples 86880
                iter: 182
                ess 845.2343124097703, samples 87360
                iter: 183
                ess 839.1122789551176, samples 87840
                iter: 184
                ess 844.7127039219682, samples 88320
                iter: 185
                ess 846.3151169334295, samples 88800
                iter: 186
                ess 842.6175583860781, samples 89280
                iter: 187
                ess 839.5348864903817, samples 89760
                iter: 188
                ess 845.649272511435, samples 90240
                iter: 189
                ess 850.4409680273976, samples 90720
                iter: 190
                ess 854.5363180594184, samples 91200
                iter: 191
                ess 864.6976297034453, samples 91680
                iter: 192
                ess 870.1598273380728, samples 92160
                iter: 193
                ess 875.8863528631218, samples 92640
                iter: 194
                ess 880.6299643478253, samples 93120
                iter: 195
                ess 887.41821530269, samples 93600
                iter: 196
                ess 893.1249868133013, samples 94080
                iter: 197
                ess 896.4293587625341, samples 94560
                iter: 198
                ess 897.194064688584, samples 95040
                iter: 199
                ess 901.6836008572618, samples 95520
                iter: 200
                ess 905.9720995421688, samples 96000
                iter: 201
                ess 915.0415219542131, samples 96480
                iter: 202
                ess 913.8491612710968, samples 96960
                iter: 203
                ess 909.5235691609382, samples 97440
                iter: 204
                ess 901.066821525769, samples 97920
                iter: 205
                ess 903.6897456054767, samples 98400
                iter: 206
                ess 905.5696263301422, samples 98880
                iter: 207
                ess 906.1574968563857, samples 99360
                iter: 208
                ess 914.8511270258749, samples 99840
                iter: 209
                ess 919.2598470161788, samples 100320
                iter: 210
                ess 931.6724515215465, samples 100800
                iter: 211
                ess 938.2402200850552, samples 101280
                iter: 212
                ess 943.4875208804775, samples 101760
                iter: 213
                ess 949.8135147561189, samples 102240
                iter: 214
                ess 955.7309221867911, samples 102720
                iter: 215
                ess 970.4592801029347, samples 103200
                iter: 216
                ess 974.074172962726, samples 103680
                iter: 217
                ess 979.1099965408358, samples 104160
                iter: 218
                ess 973.4666570148554, samples 104640
                iter: 219
                ess 983.7461092409185, samples 105120
                iter: 220
                ess 988.1624730606339, samples 105600
                iter: 221
                ess 986.9052574352414, samples 106080
                iter: 222
                ess 988.65235118233, samples 106560
                iter: 223
                ess 987.6559013720048, samples 107040
                iter: 224
                ess 992.0311000409187, samples 107520
                iter: 225
                ess 984.9431648604796, samples 108000
                iter: 226
                ess 980.0972109888816, samples 108480
                iter: 227
                ess 986.1343984234693, samples 108960
                iter: 228
                ess 986.3988313773265, samples 109440
                iter: 229
                ess 990.7939674138657, samples 109920
                iter: 230
                ess 997.9588361482485, samples 110400
                iter: 231
                ess 1004.1998163525403, samples 110880
        Billiard walk rhat: 1.0024606528800506
        CHRRT rhat: 1.010601159852741
        OHRR rhat: 1.0063622147724012
        ess {&#39;Billiard walk&#39;: 2013.7358952432155, &#39;CHRRT&#39;: 1188.850821488119, &#39;OHRR&#39;: 1004.1998163525403}
        times {&#39;Billiard walk&#39;: 1.5347769260406494, &#39;CHRRT&#39;: 0.9749472141265869, &#39;OHRR&#39;: 19.83063769340515}
        ess/t {&#39;Billiard walk&#39;: 1312.0707387999137, &#39;CHRRT&#39;: 1219.400193428071, &#39;OHRR&#39;: 50.63880606756764}
</pre></div></div>
</div>
</section>
<section id="Visualizing-the-results">
<h2>Visualizing the results<a class="headerlink" href="#Visualizing-the-results" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title_fs</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">label_fs</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">tick_fs</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">legend_fs</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">img_format</span> <span class="o">=</span> <span class="s2">&quot;pdf&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_to_plot</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ess_t_to_plot</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># restructure dicts for easier plotting</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="n">proposalTypes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">times_to_plot</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ess_t_to_plot</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">problem_selection</span> <span class="ow">in</span> <span class="n">problems_to_benchmark</span><span class="p">:</span>
        <span class="n">times_to_plot</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">problem_selection</span><span class="p">]</span> <span class="o">=</span> <span class="n">times</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
        <span class="n">ess_t_to_plot</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">problem_selection</span><span class="p">]</span> <span class="o">=</span> <span class="n">ess_t</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="visualize-runtimes">
<h2>visualize runtimes<a class="headerlink" href="#visualize-runtimes" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">problem_selection</span> <span class="o">+</span> <span class="s2">&quot; runtime results&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fs</span><span class="p">)</span>

<span class="n">X_ticks</span> <span class="o">=</span> <span class="n">problems_to_benchmark</span>

<span class="n">X_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_ticks</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">X_axis</span> <span class="o">-</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">times_to_plot</span><span class="p">[</span><span class="s2">&quot;Billiard walk&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Multiphase Billiard walk&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">X_axis</span> <span class="o">-</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">times_to_plot</span><span class="p">[</span><span class="s2">&quot;CHRRT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CHRRT&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">X_axis</span> <span class="o">+</span> <span class="mf">.3</span><span class="p">,</span> <span class="n">times_to_plot</span><span class="p">[</span><span class="s2">&quot;OHRR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OHRR&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$s$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Benchmark Problem&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">X_axis</span><span class="p">,</span> <span class="n">X_ticks</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">tick_fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">tick_fs</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">legend_fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;BenchmarkRuntimeResults.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_BenchmarkingMultiphaseMonteCarloSampling_18_0.png" src="../_images/notebooks_BenchmarkingMultiphaseMonteCarloSampling_18_0.png" />
</div>
</div>
</section>
<section id="visualize-ESS/t-[1/s]">
<h2>visualize ESS/t [1/s]<a class="headerlink" href="#visualize-ESS/t-[1/s]" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="mf">6.4</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">problem_selection</span> <span class="o">+</span> <span class="s2">&quot; ESS/t results&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fs</span><span class="p">)</span>

<span class="n">X_ticks</span> <span class="o">=</span> <span class="n">problems_to_benchmark</span>

<span class="n">X_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_ticks</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">X_axis</span> <span class="o">-</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">ess_t_to_plot</span><span class="p">[</span><span class="s2">&quot;Billiard walk&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Multiphase Billiard walk&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">X_axis</span> <span class="o">-</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">ess_t_to_plot</span><span class="p">[</span><span class="s2">&quot;CHRRT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CHRRT&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">X_axis</span> <span class="o">+</span> <span class="mf">.3</span><span class="p">,</span> <span class="n">ess_t_to_plot</span><span class="p">[</span><span class="s2">&quot;OHRR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OHRR&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\frac{\mathit</span><span class="si">{ESS}</span><span class="s2">}</span><span class="si">{t}</span><span class="s2"> [\frac</span><span class="si">{1}{s}</span><span class="s2">]$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Benchmark Problem&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">X_axis</span><span class="p">,</span> <span class="n">X_ticks</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">tick_fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">tick_fs</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">legend_fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;BenchmarkPerformanceResults.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_BenchmarkingMultiphaseMonteCarloSampling_20_0.png" src="../_images/notebooks_BenchmarkingMultiphaseMonteCarloSampling_20_0.png" />
</div>
</div>
</section>
<section id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Link to this heading">#</a></h2>
<p>In this benchmark the overrelaxed hit and run does not perform well against modern sampling algorithms. Furthermore we can see, that the performance is problem dependendent.</p>
<p>The values of the benchmark are not the main result of this script, however. Much more important is that hopsy is flexible enough to quickly construct fair benchmarks comparing novel algorithms with existing implementations. Furthermore all sampling algorithms access the models (polytopes) via the same interface, which reduces work for the methods researcher.</p>
</section>
<section id="Appendix">
<h2>Appendix<a class="headerlink" href="#Appendix" title="Link to this heading">#</a></h2>
</section>
<section id="Visualizing-the-samples">
<h2>Visualizing the samples<a class="headerlink" href="#Visualizing-the-samples" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">problem_selection</span> <span class="ow">in</span> <span class="n">samples</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">n_dims</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="s2">&quot;CHRRT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">n_cols</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_dims</span> <span class="o">/</span> <span class="n">n_cols</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">n_cols</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
        <span class="s2">&quot;Marginal densities for &quot;</span> <span class="o">+</span> <span class="n">problem_selection</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fs</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">dim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Density for </span><span class="si">{</span><span class="n">parameter_names</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="n">dim</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fs</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="s2">&quot;Billiard walk&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:,</span> <span class="n">dim</span><span class="p">],</span>
            <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Multiphase Billiard Walk&quot;</span> <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="s2">&quot;CHRRT&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:,</span> <span class="n">dim</span><span class="p">],</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CHRRT&quot;</span> <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="n">problem_selection</span><span class="p">][</span><span class="s2">&quot;OHRR&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:,</span> <span class="n">dim</span><span class="p">],</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
            <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;OHRR&quot;</span> <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">tick_fs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">tick_fs</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figlegend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">legend_fs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_BenchmarkingMultiphaseMonteCarloSampling_24_0.png" src="../_images/notebooks_BenchmarkingMultiphaseMonteCarloSampling_24_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_BenchmarkingMultiphaseMonteCarloSampling_24_1.png" src="../_images/notebooks_BenchmarkingMultiphaseMonteCarloSampling_24_1.png" />
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="TruncatedGaussianProposal.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">TMVN Sampling</p>
      </div>
    </a>
    <a class="right-next"
       href="BirkhoffPolytope.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Birkhoff polytope</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
  
    
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Motivation">Motivation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Preimplemented-Multiphase-sampling">Preimplemented Multiphase sampling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Custom-proposals">Custom proposals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#More-complex-custom-sampling-schemes">More complex custom sampling schemes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Helper-functions">Helper functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Benchmark-parameters">Benchmark parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Benchmarking">Benchmarking</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Visualizing-the-results">Visualizing the results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-runtimes">visualize runtimes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-ESS/t-[1/s]">visualize ESS/t [1/s]</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Appendix">Appendix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Visualizing-the-samples">Visualizing the samples</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/notebooks/BenchmarkingMultiphaseMonteCarloSampling.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
  

          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
  

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2021-2023, Forschungszentrum Jülich GmbH, authors: Richard D. Paul, Johann F. Jadebeck, Anton Stratmann, Katharina Nöh.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.5.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>